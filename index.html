<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no, maximum-scale=1.0, viewport-fit=cover">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<meta name="mobile-web-app-capable" content="yes">
<meta name="theme-color" content="#1a1a1a">
<script>
try{const s=JSON.parse(localStorage.getItem('zt_settings'));
if(s&&s.ux&&s.ux.theme==='light'){document.documentElement.setAttribute('data-theme','light');
document.querySelector('meta[name="theme-color"]')?.setAttribute('content','#f5f5f5')}}catch(e){}
</script>
<link rel="manifest" href="manifest.json">
<link rel="stylesheet" href="css/styles.css">
<title>Zaman Etüdü</title>
</head>
<body>

<!-- MAIN MENU -->
<div id="menuScreen" class="screen visible">
  <div class="menu-logo"><svg viewBox="0 0 24 24"><path d="M12 2C6.5 2 2 6.5 2 12s4.5 10 10 10 10-4.5 10-10S17.5 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8zm.5-13H11v6l5.2 3.2.8-1.3-4.5-2.7V7z"/></svg></div>
  <div class="menu-title">Zaman Etüdü</div>
  <div class="menu-sub">Saha Kronometresi</div>
  <div class="menu-btns">
    <button class="menu-btn menu-btn-primary" id="goMeasure"><svg viewBox="0 0 24 24"><path d="M12 2C6.5 2 2 6.5 2 12s4.5 10 10 10 10-4.5 10-10S17.5 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8zm.5-13H11v6l5.2 3.2.8-1.3-4.5-2.7V7z"/></svg>Zaman Tut</button>
    <button class="menu-btn menu-btn-secondary" id="goHistory"><svg viewBox="0 0 24 24"><path d="M13 3a9 9 0 00-9 9H1l3.89 3.89.07.14L9 12H6c0-3.87 3.13-7 7-7s7 3.13 7 7-3.13 7-7 7c-1.93 0-3.68-.79-4.94-2.06l-1.42 1.42A8.954 8.954 0 0013 21a9 9 0 000-18zm-1 5v5l4.28 2.54.72-1.21-3.5-2.08V8H12z"/></svg>Geçmiş Veriler</button>
    <button class="menu-btn menu-btn-secondary" id="goSettings"><svg viewBox="0 0 24 24"><path d="M19.14 12.94c.04-.3.06-.61.06-.94 0-.32-.02-.64-.07-.94l2.03-1.58a.49.49 0 00.12-.61l-1.92-3.32a.488.488 0 00-.59-.22l-2.39.96c-.5-.38-1.03-.7-1.62-.94l-.36-2.54a.484.484 0 00-.48-.41h-3.84c-.24 0-.43.17-.47.41l-.36 2.54c-.59.24-1.13.57-1.62.94l-2.39-.96c-.22-.08-.47 0-.59.22L2.74 8.87c-.12.21-.08.47.12.61l2.03 1.58c-.05.3-.07.62-.07.94s.02.64.07.94l-2.03 1.58a.49.49 0 00-.12.61l1.92 3.32c.12.22.37.29.59.22l2.39-.96c.5.38 1.03.7 1.62.94l.36 2.54c.05.24.24.41.48.41h3.84c.24 0 .44-.17.47-.41l.36-2.54c.59-.24 1.13-.56 1.62-.94l2.39.96c.22.08.47 0 .59-.22l1.92-3.32c.12-.22.07-.47-.12-.61l-2.01-1.58zM12 15.6A3.6 3.6 0 1112 8.4a3.6 3.6 0 010 7.2z"/></svg>Ayarlar</button>
    <button class="menu-btn menu-btn-secondary" id="goTutorial"><svg viewBox="0 0 24 24"><path d="M11 18h2v-2h-2v2zm1-16C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8zm0-14c-2.21 0-4 1.79-4 4h2c0-1.1.9-2 2-2s2 .9 2 2c0 2-3 1.75-3 5h2c0-2.25 3-2.5 3-5 0-2.21-1.79-4-4-4z"/></svg>Nasıl Kullanılır?</button>
  </div>
</div>

<!-- SETTINGS MAIN -->
<div id="settingsScreen" class="screen hidden">
  <div class="settings-header">
    <button class="te-back" id="settingsBack"><svg viewBox="0 0 24 24"><path d="M20 11H7.83l5.59-5.59L12 4l-8 8 8 8 1.41-1.41L7.83 13H20v-2z"/></svg></button>
    <h2>Ayarlar</h2>
  </div>
  <div class="settings-cats">
    <button class="settings-cat-btn" id="goSettingsMeasure">
      <div class="settings-cat-icon cat-measure"><svg viewBox="0 0 24 24"><path d="M12 2C6.5 2 2 6.5 2 12s4.5 10 10 10 10-4.5 10-10S17.5 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8zm.5-13H11v6l5.2 3.2.8-1.3-4.5-2.7V7z"/></svg></div>
      <div class="settings-cat-info"><h3>Ölçüm Ayarları</h3><p>Tempo aralığı, varsayılan tempo, otomatik kaydetme</p></div>
      <div class="settings-cat-arrow"><svg viewBox="0 0 24 24"><path d="M8.59 16.59L13.17 12 8.59 7.41 10 6l6 6-6 6z"/></svg></div>
    </button>
    <button class="settings-cat-btn" id="goSettingsStats">
      <div class="settings-cat-icon cat-stats"><svg viewBox="0 0 24 24"><path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/></svg></div>
      <div class="settings-cat-info"><h3>İstatistik Ayarları</h3><p>IQR çarpanı, histogram, hareketli ortalama</p></div>
      <div class="settings-cat-arrow"><svg viewBox="0 0 24 24"><path d="M8.59 16.59L13.17 12 8.59 7.41 10 6l6 6-6 6z"/></svg></div>
    </button>
    <button class="settings-cat-btn" id="settingsExcelBtn">
      <div class="settings-cat-icon cat-excel"><svg viewBox="0 0 24 24"><path d="M14 2H6c-1.1 0-1.99.9-1.99 2L4 20c0 1.1.89 2 1.99 2H18c1.1 0 2-.9 2-2V8l-6-6zm2 16H8v-2h8v2zm0-4H8v-2h8v2zm-3-5V3.5L18.5 9H13z"/></svg></div>
      <div class="settings-cat-info"><h3>Excel Çıktı Ayarları</h3><p>Ondalık hassasiyet, tarih formatı, dahil edilecek sayfalar</p></div>
      <div class="settings-cat-arrow"><svg viewBox="0 0 24 24"><path d="M8.59 16.59L13.17 12 8.59 7.41 10 6l6 6-6 6z"/></svg></div>
    </button>
    <button class="settings-cat-btn" id="goSettingsUx">
      <div class="settings-cat-icon cat-ux"><svg viewBox="0 0 24 24"><path d="M12 3c-4.97 0-9 4.03-9 9s4.03 9 9 9c.83 0 1.5-.67 1.5-1.5 0-.39-.15-.74-.39-1.01-.23-.26-.38-.61-.38-1 0-.83.67-1.5 1.5-1.5H16c2.76 0 5-2.24 5-5 0-4.42-4.03-8-9-8zm-5.5 9c-.83 0-1.5-.67-1.5-1.5S5.67 9 6.5 9 8 9.67 8 10.5 7.33 12 6.5 12zm3-4C8.67 8 8 7.33 8 6.5S8.67 5 9.5 5s1.5.67 1.5 1.5S10.33 8 9.5 8zm5 0c-.83 0-1.5-.67-1.5-1.5S13.67 5 14.5 5s1.5.67 1.5 1.5S15.33 8 14.5 8zm3 4c-.83 0-1.5-.67-1.5-1.5S16.67 9 17.5 9s1.5.67 1.5 1.5-.67 1.5-1.5 1.5z"/></svg></div>
      <div class="settings-cat-info"><h3>Görünüm & UX</h3><p>Tema, titreşim, bildirim süresi, tam ekran</p></div>
      <div class="settings-cat-arrow"><svg viewBox="0 0 24 24"><path d="M8.59 16.59L13.17 12 8.59 7.41 10 6l6 6-6 6z"/></svg></div>
    </button>
  </div>
</div>

<!-- SETTINGS: ÖLÇÜM AYARLARI -->
<div id="settingsMeasureScreen" class="screen hidden">
  <div class="settings-header">
    <button class="te-back" id="settingsMeasureBack"><svg viewBox="0 0 24 24"><path d="M20 11H7.83l5.59-5.59L12 4l-8 8 8 8 1.41-1.41L7.83 13H20v-2z"/></svg></button>
    <h2>Ölçüm Ayarları</h2>
  </div>
  <div class="settings-content">
    <div class="setting-item">
      <div class="setting-label">
        <span>Varsayılan Tempo Aralığı</span>
        <button class="setting-info-btn" data-info="tempoRange"><svg viewBox="0 0 24 24"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-6h2v6zm0-8h-2V7h2v2z"/></svg></button>
      </div>
      <div class="setting-control">
        <div class="setting-range-row">
          <label>Min</label>
          <input type="number" id="setTempoMin" min="10" max="95" step="5" value="50" inputmode="numeric">
          <label>Max</label>
          <input type="number" id="setTempoMax" min="105" max="200" step="5" value="150" inputmode="numeric">
          <label>Adım</label>
          <input type="number" id="setTempoStep" min="1" max="25" step="1" value="5" inputmode="numeric">
        </div>
      </div>
    </div>
    <div class="setting-item">
      <div class="setting-label">
        <span>Varsayılan Tempo Değeri</span>
        <button class="setting-info-btn" data-info="tempoDefault"><svg viewBox="0 0 24 24"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-6h2v6zm0-8h-2V7h2v2z"/></svg></button>
      </div>
      <div class="setting-control">
        <div class="setting-slider-wrap">
          <input type="range" id="setTempoDefault" min="50" max="150" step="1" value="100">
          <input type="number" class="setting-slider-input" id="setTempoDefaultVal" min="1" max="999" value="100" inputmode="numeric">
        </div>
      </div>
    </div>
    <div class="setting-item">
      <div class="setting-label">
        <span>Otomatik Kaydetme Sıklığı</span>
        <button class="setting-info-btn" data-info="autoSave"><svg viewBox="0 0 24 24"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-6h2v6zm0-8h-2V7h2v2z"/></svg></button>
      </div>
      <div class="setting-control">
        <div class="nreq-pills" id="autoSavePills">
          <button type="button" class="nreq-pill" data-val="5000">5 sn</button>
          <button type="button" class="nreq-pill sel" data-val="10000">10 sn</button>
          <button type="button" class="nreq-pill" data-val="20000">20 sn</button>
          <button type="button" class="nreq-pill" data-val="0">Her turda</button>
        </div>
      </div>
    </div>
    <div class="setting-item setting-link" id="goTagEditor">
      <div class="setting-label" style="margin-bottom:0">
        <div style="display:flex;align-items:center;gap:10px">
          <svg viewBox="0 0 24 24" width="20" height="20" fill="var(--tx2)"><path d="M17.63 5.84C17.27 5.33 16.67 5 16 5L5 5.01C3.9 5.01 3 5.9 3 7v10c0 1.1.9 1.99 2 1.99L16 19c.67 0 1.27-.33 1.63-.84L22 12l-4.37-6.16z"/></svg>
          <span>Etiketleri Düzenle</span>
        </div>
        <div class="settings-cat-arrow"><svg viewBox="0 0 24 24"><path d="M8.59 16.59L13.17 12 8.59 7.41 10 6l6 6-6 6z"/></svg></div>
      </div>
    </div>
    <button class="settings-save" id="settingsMeasureSave">KAYDET</button>
    <button class="settings-reset" id="settingsMeasureReset">Varsayılana Sıfırla</button>
  </div>
</div>

<!-- SETTINGS: İSTATİSTİK AYARLARI -->
<div id="settingsStatsScreen" class="screen hidden">
  <div class="settings-header">
    <button class="te-back" id="settingsStatsBack"><svg viewBox="0 0 24 24"><path d="M20 11H7.83l5.59-5.59L12 4l-8 8 8 8 1.41-1.41L7.83 13H20v-2z"/></svg></button>
    <h2>İstatistik Ayarları</h2>
  </div>
  <div class="settings-content">

    <!-- 1. IQR Çarpanı -->
    <div class="setting-item">
      <div class="setting-label">
        <span>IQR Çarpanı</span>
        <button class="setting-info-btn" data-info="iqrMultiplier"><svg viewBox="0 0 24 24"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-6h2v6zm0-8h-2V7h2v2z"/></svg></button>
      </div>
      <div class="setting-control">
        <div class="setting-slider-wrap">
          <input type="range" id="setIqrMultiplier" min="0.5" max="3.0" step="0.1" value="1.5">
          <input type="number" class="setting-slider-input" id="setIqrMultiplierVal" min="0.5" max="3.0" step="0.1" value="1.5" inputmode="decimal">
        </div>
        <div class="nreq-pills setting-presets" id="iqrPresets">
          <button type="button" class="nreq-pill" data-val="1.0">1.0</button>
          <button type="button" class="nreq-pill sel" data-val="1.5">1.5</button>
          <button type="button" class="nreq-pill" data-val="2.0">2.0</button>
          <button type="button" class="nreq-pill" data-val="3.0">3.0</button>
        </div>
      </div>
    </div>

    <!-- 2. Hareketli Ortalama Penceresi -->
    <div class="setting-item">
      <div class="setting-label">
        <span>Hareketli Ortalama Penceresi</span>
        <button class="setting-info-btn" data-info="movingAvgWindow"><svg viewBox="0 0 24 24"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-6h2v6zm0-8h-2V7h2v2z"/></svg></button>
      </div>
      <div class="setting-control">
        <div class="setting-slider-wrap">
          <input type="range" id="setMovingAvgWindow" min="2" max="10" step="1" value="5">
          <input type="number" class="setting-slider-input" id="setMovingAvgWindowVal" min="2" max="10" step="1" value="5" inputmode="numeric">
        </div>
      </div>
    </div>

    <!-- 3. Histogram Bin Sayısı -->
    <div class="setting-item">
      <div class="setting-label">
        <span>Histogram Bin Sayısı</span>
        <button class="setting-info-btn" data-info="histogramBins"><svg viewBox="0 0 24 24"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-6h2v6zm0-8h-2V7h2v2z"/></svg></button>
      </div>
      <div class="setting-control">
        <div class="setting-slider-wrap">
          <input type="range" id="setHistogramBins" min="5" max="30" step="1" value="10">
          <input type="number" class="setting-slider-input" id="setHistogramBinsVal" min="5" max="30" step="1" value="10" inputmode="numeric">
        </div>
      </div>
    </div>

    <!-- 4. Mod Yuvarlama Hassasiyeti -->
    <div class="setting-item">
      <div class="setting-label">
        <span>Mod Yuvarlama Hassasiyeti</span>
        <button class="setting-info-btn" data-info="modeRounding"><svg viewBox="0 0 24 24"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-6h2v6zm0-8h-2V7h2v2z"/></svg></button>
      </div>
      <div class="setting-control">
        <div class="nreq-pills" id="modeRoundingPills">
          <button type="button" class="nreq-pill" data-val="1">1 ms</button>
          <button type="button" class="nreq-pill" data-val="5">5 ms</button>
          <button type="button" class="nreq-pill sel" data-val="10">10 ms</button>
          <button type="button" class="nreq-pill" data-val="50">50 ms</button>
          <button type="button" class="nreq-pill" data-val="100">100 ms</button>
        </div>
      </div>
    </div>

    <!-- 5. Yüzdelik Dilim Setleri (Multi-select) -->
    <div class="setting-item">
      <div class="setting-label">
        <span>Yüzdelik Dilim Setleri</span>
        <button class="setting-info-btn" data-info="percentiles"><svg viewBox="0 0 24 24"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-6h2v6zm0-8h-2V7h2v2z"/></svg></button>
      </div>
      <div class="setting-control">
        <div class="nreq-pills setting-multi" id="percentilePills">
          <button type="button" class="nreq-pill" data-val="5">P5</button>
          <button type="button" class="nreq-pill sel" data-val="10">P10</button>
          <button type="button" class="nreq-pill sel" data-val="25">P25</button>
          <button type="button" class="nreq-pill sel" data-val="50">P50</button>
          <button type="button" class="nreq-pill sel" data-val="75">P75</button>
          <button type="button" class="nreq-pill sel" data-val="90">P90</button>
          <button type="button" class="nreq-pill" data-val="95">P95</button>
        </div>
      </div>
    </div>

    <!-- 6. Trend Eşik Değeri (R²) -->
    <div class="setting-item">
      <div class="setting-label">
        <span>Trend Eşik Değeri (R²)</span>
        <button class="setting-info-btn" data-info="trendThreshold"><svg viewBox="0 0 24 24"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-6h2v6zm0-8h-2V7h2v2z"/></svg></button>
      </div>
      <div class="setting-control">
        <div class="setting-slider-wrap">
          <input type="range" id="setTrendThreshold" min="0.01" max="0.50" step="0.01" value="0.10">
          <input type="number" class="setting-slider-input" id="setTrendThresholdVal" min="0.01" max="0.50" step="0.01" value="0.10" inputmode="decimal">
        </div>
      </div>
    </div>

    <!-- 7. Güven Düzeyi Varsayılanı -->
    <div class="setting-item">
      <div class="setting-label">
        <span>Güven Düzeyi Varsayılanı</span>
        <button class="setting-info-btn" data-info="defaultConfidence"><svg viewBox="0 0 24 24"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-6h2v6zm0-8h-2V7h2v2z"/></svg></button>
      </div>
      <div class="setting-control">
        <div class="nreq-pills" id="defaultConfPills">
          <button type="button" class="nreq-pill" data-val="0.90">%90</button>
          <button type="button" class="nreq-pill sel" data-val="0.95">%95</button>
          <button type="button" class="nreq-pill" data-val="0.99">%99</button>
        </div>
      </div>
    </div>

    <!-- 8. Hata Payı Varsayılanı -->
    <div class="setting-item">
      <div class="setting-label">
        <span>Hata Payı Varsayılanı</span>
        <button class="setting-info-btn" data-info="defaultErrorMargin"><svg viewBox="0 0 24 24"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-6h2v6zm0-8h-2V7h2v2z"/></svg></button>
      </div>
      <div class="setting-control">
        <div class="nreq-pills" id="defaultErrPills">
          <button type="button" class="nreq-pill" data-val="0.03">±%3</button>
          <button type="button" class="nreq-pill sel" data-val="0.05">±%5</button>
          <button type="button" class="nreq-pill" data-val="0.10">±%10</button>
        </div>
      </div>
    </div>

    <button class="settings-save" id="settingsStatsSave">KAYDET</button>
    <button class="settings-reset" id="settingsStatsReset">Varsayılana Sıfırla</button>
  </div>
</div>

<!-- SETTINGS: EXCEL ÇIKTI AYARLARI -->
<div id="settingsExcelScreen" class="screen hidden">
  <div class="settings-header">
    <button class="te-back" id="settingsExcelBack"><svg viewBox="0 0 24 24"><path d="M20 11H7.83l5.59-5.59L12 4l-8 8 8 8 1.41-1.41L7.83 13H20v-2z"/></svg></button>
    <h2>Excel Çıktı Ayarları</h2>
  </div>
  <div class="settings-content">

    <!-- 1. Ondalık Hassasiyet -->
    <div class="setting-item">
      <div class="setting-label">
        <span>Ondalık Hassasiyet</span>
        <button class="setting-info-btn" data-info="excelDecimalPrecision"><svg viewBox="0 0 24 24"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-6h2v6zm0-8h-2V7h2v2z"/></svg></button>
      </div>
      <div class="setting-control">
        <div class="setting-slider-wrap">
          <input type="range" id="excelDecimalSlider" min="1" max="6" step="1" value="3">
          <input type="number" class="setting-slider-input" id="excelDecimalInput" min="1" max="6" step="1" value="3" inputmode="numeric">
        </div>
      </div>
    </div>

    <!-- 2. Tarih Formatı -->
    <div class="setting-item">
      <div class="setting-label">
        <span>Tarih Formatı</span>
        <button class="setting-info-btn" data-info="excelDateFormat"><svg viewBox="0 0 24 24"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-6h2v6zm0-8h-2V7h2v2z"/></svg></button>
      </div>
      <div class="setting-control">
        <div class="nreq-pills" id="excelDatePills">
          <button type="button" class="nreq-pill sel" data-val="tr">GG.AA.YYYY SS:DD</button>
          <button type="button" class="nreq-pill" data-val="iso">YYYY-AA-GG SS:DD</button>
          <button type="button" class="nreq-pill" data-val="eu">GG/AA/YYYY SS:DD</button>
        </div>
      </div>
    </div>

    <!-- 3. Dahil Edilecek Sayfalar -->
    <div class="setting-item">
      <div class="setting-label">
        <span>Dahil Edilecek Sayfalar</span>
        <button class="setting-info-btn" data-info="excelIncludeSheets"><svg viewBox="0 0 24 24"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-6h2v6zm0-8h-2V7h2v2z"/></svg></button>
      </div>
      <div class="setting-control">
        <div class="sheet-group-label">Ortak Sayfalar</div>
        <div class="nreq-pills setting-multi" id="excelSheetPills">
          <button type="button" class="nreq-pill sel mandatory" data-sheet="ozet">Özet</button>
          <button type="button" class="nreq-pill sel mandatory" data-sheet="hamVeri">Ham Veri</button>
          <button type="button" class="nreq-pill sel" data-sheet="etiketAnalizi">Etiket Analizi</button>
          <button type="button" class="nreq-pill sel" data-sheet="dagilimAnalizi">Dağılım Analizi</button>
          <button type="button" class="nreq-pill sel" data-sheet="trendAnalizi">Trend Analizi</button>
          <button type="button" class="nreq-pill sel" data-sheet="aykiriDegerler">Aykırı Değerler</button>
          <button type="button" class="nreq-pill sel" data-sheet="tempoAnalizi">Tempo Analizi</button>
          <button type="button" class="nreq-pill sel" data-sheet="notlar">Notlar</button>
          <button type="button" class="nreq-pill sel" data-sheet="konfigurasyon">Konfigürasyon</button>
          <button type="button" class="nreq-pill sel" data-sheet="terimlerSozlugu">Terimler Sözlüğü</button>
        </div>
        <div class="sheet-group-label">Ardışık Mod Sayfaları</div>
        <div class="nreq-pills setting-multi" id="excelSeqSheetPills">
          <button type="button" class="nreq-pill sel" data-sheet="cevrimAnalizi">Çevrim Analizi</button>
          <button type="button" class="nreq-pill sel" data-sheet="adimAnalizi">Adım Analizi</button>
          <button type="button" class="nreq-pill sel" data-sheet="adimKarsilastirma">Adım Karşılaştırma</button>
          <button type="button" class="nreq-pill sel" data-sheet="anomaliAnalizi">Anomali Analizi</button>
          <button type="button" class="nreq-pill sel" data-sheet="cevrimTrend">Çevrim Trend</button>
        </div>
      </div>
    </div>

    <button class="settings-save" id="settingsExcelSave">KAYDET</button>
    <button class="settings-reset" id="settingsExcelReset">Varsayılana Sıfırla</button>
  </div>
</div>

<!-- SETTINGS: GÖRÜNÜM & UX AYARLARI -->
<div id="settingsUxScreen" class="screen hidden">
  <div class="settings-header">
    <button class="te-back" id="settingsUxBack"><svg viewBox="0 0 24 24"><path d="M20 11H7.83l5.59-5.59L12 4l-8 8 8 8 1.41-1.41L7.83 13H20v-2z"/></svg></button>
    <h2>Görünüm & UX Ayarları</h2>
  </div>
  <div class="settings-content">

    <!-- 1. Tema -->
    <div class="setting-item">
      <div class="setting-label">
        <span>Tema</span>
        <button class="setting-info-btn" data-info="uxTheme"><svg viewBox="0 0 24 24"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-6h2v6zm0-8h-2V7h2v2z"/></svg></button>
      </div>
      <div class="setting-control">
        <div class="nreq-pills" id="uxThemePills">
          <button type="button" class="nreq-pill sel" data-val="dark">Koyu</button>
          <button type="button" class="nreq-pill" data-val="light">Açık</button>
        </div>
      </div>
    </div>

    <!-- 2. Titreşim -->
    <div class="setting-item">
      <div class="setting-label">
        <span>Titreşim Geri Bildirimi</span>
        <button class="setting-info-btn" data-info="uxVibration"><svg viewBox="0 0 24 24"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-6h2v6zm0-8h-2V7h2v2z"/></svg></button>
      </div>
      <div class="setting-control">
        <div class="nreq-pills" id="uxVibrationPills">
          <button type="button" class="nreq-pill sel" data-val="true">Açık</button>
          <button type="button" class="nreq-pill" data-val="false">Kapalı</button>
        </div>
      </div>
    </div>

    <!-- 3. Toast Bildirim Süresi -->
    <div class="setting-item">
      <div class="setting-label">
        <span>Toast Bildirim Süresi</span>
        <button class="setting-info-btn" data-info="uxToastDuration"><svg viewBox="0 0 24 24"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-6h2v6zm0-8h-2V7h2v2z"/></svg></button>
      </div>
      <div class="setting-control">
        <div class="nreq-pills" id="uxToastPills">
          <button type="button" class="nreq-pill" data-val="1000">1 sn</button>
          <button type="button" class="nreq-pill sel" data-val="2000">2 sn</button>
          <button type="button" class="nreq-pill" data-val="3000">3 sn</button>
          <button type="button" class="nreq-pill" data-val="5000">5 sn</button>
        </div>
      </div>
    </div>

    <!-- 4. Tam Ekran Modu -->
    <div class="setting-item">
      <div class="setting-label">
        <span>Tam Ekran Modu</span>
        <button class="setting-info-btn" data-info="uxFullscreen"><svg viewBox="0 0 24 24"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-6h2v6zm0-8h-2V7h2v2z"/></svg></button>
      </div>
      <div class="setting-control">
        <div class="nreq-pills" id="uxFullscreenPills">
          <button type="button" class="nreq-pill sel" data-val="true">Açık</button>
          <button type="button" class="nreq-pill" data-val="false">Kapalı</button>
        </div>
      </div>
    </div>

    <button class="settings-save" id="settingsUxSave">KAYDET</button>
    <button class="settings-reset" id="settingsUxReset">Varsayılana Sıfırla</button>
  </div>
</div>

<!-- SETTINGS INFO MODAL -->
<div class="modal-ov" id="settingsInfoModal">
  <div class="modal-box">
    <div class="modal-t" id="settingsInfoTitle">Bilgi</div>
    <div class="modal-p" id="settingsInfoText"></div>
    <div class="modal-acts">
      <button class="modal-btn m-confirm" id="settingsInfoClose">Tamam</button>
    </div>
  </div>
</div>

<!-- MODE SELECT -->
<div id="modeSelectScreen" class="screen hidden">
  <div class="mode-title">Ölçüm Modu Seçin</div>
  <div class="mode-sub">Yapmak istediğiniz zaman etüdü türüne göre bir mod seçin</div>
  <div class="mode-cards">
    <div class="mode-card" id="modeRepeat" role="button" tabindex="0">
      <div class="mode-card-icon"><svg viewBox="0 0 24 24"><path d="M12 4V1L8 5l4 4V6c3.31 0 6 2.69 6 6 0 1.01-.25 1.97-.7 2.8l1.46 1.46A7.93 7.93 0 0020 12c0-4.42-3.58-8-8-8zm0 14c-3.31 0-6-2.69-6-6 0-1.01.25-1.97.7-2.8L5.24 7.74A7.93 7.93 0 004 12c0 4.42 3.58 8 8 8v3l4-4-4-4v3z"/></svg></div>
      <h3>Tekrarlı Ölçüm</h3>
      <p>Aynı işlem tekrar tekrar yapılır ve her tekrar ölçülür. Ortalama süre, standart sapma ve gerekli gözlem sayısı hesaplanır.</p>
    </div>
    <div class="mode-card" id="modeSequence" role="button" tabindex="0">
      <div class="mode-card-icon mode-seq"><svg viewBox="0 0 24 24"><path d="M3 5h2v14H3V5zm4 0h2v14H7V5zm4 0h2v14h-2V5zm4 0h2v14h-2V5zm4 0h2v14h-2V5z"/></svg></div>
      <h3>Ardışık İşlem</h3>
      <p>Birbirini takip eden farklı iş adımları sırasıyla ölçülür. Her adım için ayrı istatistikler hesaplanır.</p>
    </div>
  </div>
  <button class="mode-back" id="modeBack">Geri Dön</button>
</div>

<!-- SETUP -->
<div id="setupScreen" class="screen hidden">
  <form class="setup-form" id="setupForm" style="margin:auto">
    <div class="setup-title" id="setupTitle">Yeni Ölçüm</div>
    <div class="setup-mode-hint" id="setupModeHint" style="font-size:clamp(10px,3vw,13px);color:var(--tx2);text-align:center;margin-bottom:clamp(8px,2vh,16px);line-height:1.5"></div>
    <div class="inp-grp"><label>Operatör Adı</label><input type="text" id="inpOp" placeholder="İşi yapan kişinin adını girin" autocomplete="off" required></div>
    <div class="inp-grp"><label>İş / Proses Adı</label><input type="text" id="inpJob" placeholder="İş tanımını girin" autocomplete="off" required></div>
    <div class="nreq-params" id="nreqParams">
      <div class="nreq-title">Ne Kadar Ölçüm Gerekli?</div>
      <div class="nreq-sub">Güven düzeyi ve kabul edilebilir hata payını belirleyin</div>
      <div class="nreq-row"><label>Güven Düzeyi</label><div class="nreq-pills" id="nreqConfPills"><button type="button" class="nreq-pill" data-val="0.90">%90</button><button type="button" class="nreq-pill sel" data-val="0.95">%95</button><button type="button" class="nreq-pill" data-val="0.99">%99</button></div></div>
      <div class="nreq-row"><label>Hata Payı</label><div class="nreq-pills" id="nreqErrPills"><button type="button" class="nreq-pill" data-val="0.03">±%3</button><button type="button" class="nreq-pill sel" data-val="0.05">±%5</button><button type="button" class="nreq-pill" data-val="0.10">±%10</button></div></div>
    </div>
    <div id="setupStepsPreview" style="display:none;margin:clamp(8px,2vh,12px) 0"></div>
    <button type="submit" class="btn-go">BAŞLAT</button>
    <button type="button" class="btn-back" id="setupBack">Geri Dön</button>
  </form>
</div>

<!-- TAG EDITOR -->
<div id="tagEditorScreen" class="screen hidden">
  <div class="te-header">
    <button class="te-back" id="teBack"><svg viewBox="0 0 24 24"><path d="M20 11H7.83l5.59-5.59L12 4l-8 8 8 8 1.41-1.41L7.83 13H20v-2z"/></svg></button>
    <h2>Etiketleri Düzenle</h2>
  </div>
  <div id="teList"></div>
  <button class="te-save" id="teSave">KAYDET</button>
</div>

<!-- HISTORY -->
<div id="historyScreen" class="screen hidden">
  <div class="hi-header">
    <button class="te-back" id="hiBack"><svg viewBox="0 0 24 24"><path d="M20 11H7.83l5.59-5.59L12 4l-8 8 8 8 1.41-1.41L7.83 13H20v-2z"/></svg></button>
    <h2>Geçmiş Veriler</h2>
  </div>
  <div id="hiList"></div>
</div>

<!-- MEASUREMENT -->
<div id="measureScreen" class="screen hidden">
  <div class="edge-flash" id="edgeFlash"></div>
  <div class="top-bar">
    <div class="top-bar-info"><div class="job-name" id="dJob">—</div><div class="op-name" id="dOp">—</div></div>
    <button class="btn-pause-top" id="bPause"><svg viewBox="0 0 24 24" id="pauseIcon"><path d="M6 19h4V5H6v14zm8-14v14h4V5h-4z"/></svg><span id="pauseText">Duraklat</span></button>
    <div class="top-bar-acts">
      <button class="btn-ic danger" id="bStop" title="Bitir (Q)"><svg viewBox="0 0 24 24"><path d="M6 6h12v12H6z"/></svg></button>
    </div>
  </div>
  <div class="tag-strip" id="tagStrip"></div>
  <div class="step-indicator" id="stepIndicator">
    <div class="step-top-row">
      <div class="step-current">
        <span class="step-name-label">Şu anki adım:</span>
        <span class="step-name" id="stepName" title="Düzenlemek için tıkla">—</span>
      </div>
      <div class="step-cycle" id="stepCycle">Çevrim 1</div>
    </div>
    <div class="step-dots" id="stepDots"></div>
  </div>
  <div class="timer-area" id="timerArea">
    <div class="nreq-live" id="nreqLive"></div>
    <div class="timer-tempo-wrap">
      <div class="timer-ring">
        <svg class="timer-ring-svg" viewBox="0 0 200 200"><circle class="ring-bg" cx="100" cy="100" r="90"/><circle class="ring-prog" id="ringProg" cx="100" cy="100" r="90"/></svg>
        <div class="timer-display">
          <div class="timer-time" id="tTime">00:00</div>
          <div class="timer-ms" id="tMs">.00</div>
          <div class="timer-st" id="tState">Başlamak için dokun</div>
        </div>
      </div>
      <div class="tempo-picker" id="tempoPicker">
        <div class="tempo-picker-label">Tempo %</div>
        <div class="tempo-wheel" id="tempoWheel">
          <div class="tempo-items" id="tempoItems"></div>
        </div>
      </div>
    </div>
    <div class="tap-hint" id="tapHint">Ekrana dokun = Tur kaydet</div>
    <div class="lap-ctr" id="lapCtr" style="display:none"><svg viewBox="0 0 24 24" width="14" height="14" fill="currentColor"><path d="M4 10.5c-.83 0-1.5.67-1.5 1.5s.67 1.5 1.5 1.5 1.5-.67 1.5-1.5-.67-1.5-1.5-1.5zm0-6c-.83 0-1.5.67-1.5 1.5S3.17 7.5 4 7.5 5.5 6.83 5.5 6 4.83 4.5 4 4.5zm0 12c-.83 0-1.5.68-1.5 1.5s.68 1.5 1.5 1.5 1.5-.68 1.5-1.5-.67-1.5-1.5-1.5zM7 19h14v-2H7v2zm0-6h14v-2H7v2zm0-8v2h14V5H7z"/></svg><span class="cnt" id="lapN">0</span> tur</div>
  </div>
  <div class="lap-wrap" id="lapWrap"><div class="lap-list" id="lapList"></div></div>
  <div class="kb-bar">
    <span><kbd>Space</kbd> Tur</span>
    <span><kbd>1</kbd><kbd>2</kbd><kbd>3</kbd><kbd>4</kbd> Etiketli tur</span>
    <span><kbd>+</kbd><kbd>−</kbd> Tempo</span>
    <span><kbd>P</kbd> Duraklat</span>
    <span><kbd>Q</kbd> Bitir</span>
    <span><kbd>Sağ tık</kbd> Etiketle</span>
  </div>
</div>

<!-- SUMMARY -->
<div id="summaryScreen" class="screen hidden"></div>

<!-- NOTE PANEL -->
<div class="overlay" id="noteOv"></div>
<div class="panel" id="notePanel">
  <div class="panel-handle"></div>
  <div class="panel-title">Not Ekle</div>
  <div class="note-chips" id="noteChips"></div>
  <textarea class="note-ta" id="noteTa" placeholder="Notunuzu yazın..."></textarea>
  <button class="note-save" id="noteSave">KAYDET</button>
</div>

<!-- TAG PICKER -->
<div class="overlay" id="tpOv"></div>
<div class="panel" id="tpPanel" style="max-width:420px;left:50%;right:auto;transform:translateX(-50%) translateY(100%)">
  <div class="panel-handle"></div>
  <div class="panel-title" id="tpTitle">Etiket Seç</div>
  <div class="tp-grid" id="tpGrid"></div>
</div>

<!-- STEP NAME EDIT PANEL -->
<div class="overlay" id="stepOv"></div>
<div class="panel" id="stepPanel" style="max-width:340px;left:50%;right:auto;transform:translateX(-50%) translateY(100%)">
  <div class="panel-handle"></div>
  <div class="panel-title" id="stepPanelTitle">Adım Adını Düzenle</div>
  <div class="inp-grp" style="margin-bottom:12px">
    <label>Adım Adı</label>
    <input type="text" id="stepNameInput" placeholder="Adım adını girin" maxlength="30">
  </div>
  <button class="te-save-btn" id="stepSaveBtn">KAYDET</button>
</div>

<!-- TEMPO EDIT PANEL -->
<div class="overlay" id="teOv"></div>
<div class="panel" id="tePanel" style="max-width:320px;left:50%;right:auto;transform:translateX(-50%) translateY(100%)">
  <div class="panel-handle"></div>
  <div class="panel-title" id="teTitle">Tempo Düzenle</div>
  <div class="te-tempo-wrap">
    <button class="te-tempo-btn" id="teMinus">−</button>
    <input type="number" class="te-tempo-input" id="teInput" min="50" max="150" step="5" value="100">
    <button class="te-tempo-btn" id="tePlus">+</button>
  </div>
  <div class="te-presets">
    <button class="te-preset" data-val="75">75</button>
    <button class="te-preset" data-val="100">100</button>
    <button class="te-preset" data-val="125">125</button>
  </div>
  <button class="te-save-btn" id="teSaveBtn">KAYDET</button>
</div>

<!-- TOAST -->
<div class="toast-c" id="toastC"></div>
<input type="file" id="jsonImportInput" accept=".json" style="display:none">

<!-- FINISH MODAL -->
<div class="modal-ov" id="finModal">
  <div class="modal-box">
    <div class="modal-t">Ölçümü Bitir</div>
    <div class="modal-p">Tüm tur verileri kaydedilecek ve özet gösterilecek. Devam etmek istiyor musunuz?</div>
    <div class="modal-acts">
      <button class="modal-btn m-cancel" id="mCancel">Vazgeç</button>
      <button class="modal-btn m-confirm" id="mConfirm">Bitir</button>
    </div>
  </div>
</div>

<!-- RECOVERY MODAL - Yarım kalan ölçümü kurtar -->
<div class="modal-ov" id="recoveryModal">
  <div class="modal-box">
    <div class="modal-t">Yarım Kalan Ölçüm</div>
    <div class="modal-p" id="recoveryInfo">Tamamlanmamış bir ölçüm bulundu. Devam etmek ister misiniz?</div>
    <div class="modal-acts">
      <button class="modal-btn m-cancel" id="recDiscard">Sil</button>
      <button class="modal-btn m-confirm" id="recRestore">Devam Et</button>
    </div>
  </div>
</div>

<!-- SUMMARY DELETE MODAL -->
<div class="modal-ov" id="sumDelModal">
  <div class="modal-box">
    <div class="modal-t">Turu Sil</div>
    <div class="modal-p">Bu turu silmek istediğinizden emin misiniz? Kümülatif süreler ve tur numaraları yeniden hesaplanacak.</div>
    <div class="modal-acts">
      <button class="modal-btn m-cancel" id="sdCancel">Vazgeç</button>
      <button class="modal-btn m-confirm" id="sdConfirm">Sil</button>
    </div>
  </div>
</div>

<!-- HISTORY DELETE MODAL -->
<div class="modal-ov" id="hiDelModal">
  <div class="modal-box">
    <div class="modal-t">Ölçümü Sil</div>
    <div class="modal-p">Bu ölçüm kaydını silmek istediğinizden emin misiniz? Bu işlem geri alınamaz.</div>
    <div class="modal-acts">
      <button class="modal-btn m-cancel" id="hdCancel">Vazgeç</button>
      <button class="modal-btn m-confirm" id="hdConfirm">Sil</button>
    </div>
  </div>
</div>

<!-- STEP SETUP CHOICE MODAL -->
<div class="modal-ov" id="stepChoiceModal">
  <div class="modal-box">
    <div class="modal-t">Adımları Belirle</div>
    <div class="modal-p">Ölçüme başlamadan önce iş adımlarını belirlemek ister misiniz?</div>
    <div class="modal-acts">
      <button class="modal-btn m-cancel" id="stepChoiceNo">Hayır, Varsayılan</button>
      <button class="modal-btn m-primary" id="stepChoiceYes">Evet, Belirle</button>
    </div>
  </div>
</div>

<!-- STEP SETUP SCREEN -->
<div id="stepSetupScreen" class="screen hidden">
  <div class="step-setup-header">
    <button class="te-back" id="stepSetupBack"><svg viewBox="0 0 24 24"><path d="M20 11H7.83l5.59-5.59L12 4l-8 8 8 8 1.41-1.41L7.83 13H20v-2z"/></svg></button>
    <h2>Adımları Düzenle</h2>
  </div>
  <div class="step-setup-hint">Her işlem adımı için bir isim girin. Ölçüm sırasında da değiştirilebilir.</div>
  <div class="step-setup-list" id="stepSetupList"></div>
  <button class="step-setup-add" id="stepSetupAdd">+ Yeni Adım Ekle</button>
  <button class="btn-go" id="stepSetupDone">DEVAM ET</button>
</div>

<script type="module" src="js/main.js"></script>
</body>
</html>
